pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
--main functions

function _update()
		player_update()
		printh(pl.dy)
end

function _draw()
		cls()
		map(0,0)
		spr(pl.sp,pl.x,pl.y)
end	

function _init()
		player_init()
end
-->8
--player

function player_init()
		pl={
				sp=1,
				x=60,
				y=60,
				dx=0,
				dy=0,
				w=8,
				h=8,
		}
end

function player_update()
		if btn(⬆️) then
				pl.dy-=1
				pl.sp=2
		end
		
		if btn(⬇️) then
				pl.dy+=1
				pl.sp=1
		end
		
		if btn(➡️) then
				pl.dx+=1
				pl.sp=3
		end
		
		if btn(⬅️) then
				pl.dx-=1
				pl.sp=4
		end
		
		if pl.dy<1 then
				if collide_map(pl,"up",0) then
						pl.dy=0
				else
					 pl.y+=pl.dy
						pl.dy=0
				end
		end
		
		if pl.dy>0 then
				if collide_map(pl,"down",0) then
						pl.dy=0
				else
						pl.y+=pl.dy
						pl.dy=0
				end
		end
end

function player_draw()

end
-->8
--collisions
-------------------------------

function collide_map(obj,aim,flag)
		--obj = table needs x,y,w,h
		--aim = left,right,up, dowm
		
		local x=obj.x local y=obj.y
		local w=obj.w	local h=obj.h
		
		local x2=0		local y2=0
		local x1=0		local y1=0
		
		if aim=="left" then
				x1=x-11		y1=y
				x2=x					y2=y+h-1
				
		elseif aim=="right" then
				x1=x+w				y1=y
				x2=x+w+1		y2=y+h-1
		
		elseif aim=="up" then
				x1=x+1				y1=y-1
				x2=x+w-1		y2=y
		
		elseif aim=="dowm" then
				x1=x      y1=y+h
				x2=x+w				y2=y+h
		end
		
		--pixels to tiles
		x1/=8		y1/=8
		x2/=8		y2/=8
		
		--checks each corner for flag
		if fget(mget(x1,y1), flag)
		or fget(mget(x2,y1), flag)
		or fget(mget(x2,y2), flag)
		or fget(mget(x1,y2), flag) then
				return true
		else
				return flase
		end
		
		
		
end
__gfx__
000000000333333003333330003333000033330011111d1155555d55000000000000000000000000000000000000000000000000000000000000000000000000
00000000aaaaaaaaaaaaaaaa00aaaa0000aaaa0055555d15d5555555000000000000000000000000000000000000000000000000000000000000000000000000
00700700afdffdfaaaaaaaaa00aafd0000dfaa0055555d1555555555000000000000000000000000000000000000000000000000000000000000000000000000
000770000ffffff00aaaaaa000aaff0000ffaa00dddddddd55d55555000000000000000000000000000000000000000000000000000000000000000000000000
00077000088888800888888000088000000880001d111111555555d5000000000000000000000000000000000000000000000000000000000000000000000000
00700700008888000088880000088000000880005d15555555555555000000000000000000000000000000000000000000000000000000000000000000000000
00000000001111000011110000011000000110005d1555555555d555000000000000000000000000000000000000000000000000000000000000000000000000
0000000000400400004004000004400000044000dddddddd55555555000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0505050505050505050505050505050505050505050505050505050505050505050505050505050606050505050505050505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060606060606060606060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060606060606060606060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060505050505050506060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060506060606060606060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060506060606060606060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060506060505050505050505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060506060506060606060606060606060606060606060606060605060606060606060606060606060606050606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060506060506060606060606060606060606060606060606060605060606060606060606060606060606050606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060506060505050506060505050505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060606060606050606060506060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060606060606050606050506060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050606050606050506060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060606060606060606060606060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506060606060606060606060606060505060606060606060606060606060605050606060606060606060606060606050606060606060606060606060606060500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505060605050505050505050505050505050505050505050505050505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
