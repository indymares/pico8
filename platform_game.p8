pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
--main code
function _init()
		player={
				x=10,
				y=72,
				dx=0,--change in x
				dy=0,--change in y
				s=3,
				h=8,
				w=8,
				wlk=false,
				tm=4,
				f=false,
				boost=4,
				}
				gravity=0.3
				landed=false
end

function _draw()
		cls(12)
		map(0,0)
		spr(player.s,player.x,player.y,
						1,1,player.f)
end

function _update()
		player_update()
		player_animate()
end


-->8
--player

function player_update()
		player.wlk=false
		
		player.dy+=gravity
		
		if btn(➡️) then
				player.dx+=1
				player.wlk=true
				player.f=false
		end
		
		if btn(⬅️) then
				player.dx-=1
				player.wlk=true
				player.f=true
		end
		
		if btn(❎) and
				 player.landed==true then
				player.dy-=player.boost
		end 
		
		--check collision up and down
		if player.dy>0 then
				player.falling=true
				player.landed=false
				player.jumping=false
				
				if collide_map(player,"dowm",0) then
						player.landed=true
						player.falling=false
						player.dy=0
						--this makes sure spr lands
						--on top of block
						player.y-=(player.y+player.h)%8
				end
		elseif player.dy<0 then
				player.jumping=true
				if collide_map(player,"up",1) then
					player.dy=0
				end
		end
end
		
function player_animate()		
		if w==true then
				tm-=1
				if tm<0 then
						s+=1
						tm=4
						if s>5 then 
								s=3
						end
				end
		else
				s=3 --stationary sprite
		end
end
-->8
--collisions
-------------------------------

function collide_map(obj,aim,flag)
		--obj = table needs x,y,w,h
		--aim = left,right,up, dowm
		
		local x=obj.x local y=obj.y
		local w=obj.w	local h=obj.h
		
		local x2=0		local y2=0
		local x1=0		local y1=0
		
		if aim=="left" then
				x1=x-11		y1=y
				x2=x					y2=y+h-1
				
		elseif aim=="right" then
				x1=x+w				y1=y
				x2=x+w+1		y2=y+h-1
		
		elseif aim=="up" then
				x1=x+1				y1=y-1
				x2=x+w-1		y2=y
		
		elseif aim=="dowm" then
				x1=x      y1=y+h
				x2=x+w				y2=y+h
		end
		
		--pixels to tiles
		x1/=8		y1/=8
		x2/=8		y2/=8
		
		--checks each corner for flag
		if fget(mget(x1,y1), flag)
		or fget(mget(x2,y1), flag)
		or fget(mget(x2,y2), flag)
		or fget(mget(x1,y2), flag) then
				return true
		else
				return flase
		end
		
		
		
end
__gfx__
000000003333b33344444444044444400444444004444440000000000000000044944494bbbbbbbb000000000000000000000000000000000000000000000000
000000003b333b334944944404fffff004fffff004fffff00000000000aaaa0044944944b3bbbbbb000000000000000000000000000000000000000000000000
00700700433333334444444404fffdf004fffdf004fffdf00000000000a99a0044944944bbbbb3bb000000000000000000000000000000000000000000000000
000770004444443b4494449404fffff004fffff040fffff00000000000a9aa0044944494bbbbbbbb000000000000000000000000000000000000000000000000
0007700094449443444444440408800040088000400880000000000000a9aa0044494494bb3bbbbb000000000000000000000000000000000000000000000000
0070070044444494944444440408800040088000400880000000000000a99a0044944494bbbbbbbb000000000000000000000000000000000000000000000000
0000000049444444444444940001100000011000000110000000000000aaaa0044944494bbbbbb3b000000000000000000000000000000000000000000000000
0000000044444494444444440001100000010100001010000000000000000000449444943bbbbbbb000000000000000000000000000000000000000000000000
00000000b3333b330000000004444440044444400444444000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000033b333430000000004444440044444400444444000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000003444944b0000000004444440044444400444444000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000494449440000000004444440044444404044444000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000544944550000000004088000400880004008800000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555545500000000004088000400880004008800000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000555000000000000011000000110000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000011000000101000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000009090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000111111110000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
